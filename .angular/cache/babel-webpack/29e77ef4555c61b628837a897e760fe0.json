{"ast":null,"code":"function e(e) {\n  return e && e.origin ? e.origin : \"https://stackblitz.com\";\n}\n\nvar t = \"300\";\n\nfunction n() {\n  return Math.random().toString(36).substring(7);\n}\n\nfunction i(e) {\n  var t = \"\";\n  return e ? (e.forceEmbedLayout && (t += \"embed=1\"), e.clickToLoad && (t += (t.length ? \"&\" : \"\") + \"ctl=1\"), e.openFile && (t += (t.length ? \"&\" : \"\") + \"file=\" + e.openFile), !e.view || \"preview\" !== e.view && \"editor\" !== e.view || (t += (t.length ? \"&\" : \"\") + \"view=\" + e.view), e.theme && (t += (t.length ? \"&\" : \"\") + \"theme=\" + e.theme), e.hideExplorer && (t += (t.length ? \"&\" : \"\") + \"hideExplorer=1\"), e.hideNavigation && (t += (t.length ? \"&\" : \"\") + \"hideNavigation=1;\"), e.hideDevTools && (t += (t.length ? \"&\" : \"\") + \"hidedevtools=1\"), e.initialPath && (t += (t.length ? \"&\" : \"\") + \"initialpath=\" + encodeURIComponent(e.initialPath)), \"number\" == typeof e.devToolsHeight && e.devToolsHeight > 0 && e.devToolsHeight < 100 && (t += (t.length ? \"&\" : \"\") + \"devtoolsheight=\" + e.devToolsHeight), t.length ? \"?\" + t : t) : t;\n}\n\nfunction o(e, t, n) {\n  if (null === e.parentNode) throw new Error(\"Invalid Element\");\n  t.id = e.id, d(t, n), e.parentNode.replaceChild(t, e);\n}\n\nfunction r(e) {\n  if (\"string\" == typeof e) {\n    var t = document.getElementById(e);\n    if (null !== t) return t;\n  } else if (e instanceof HTMLElement) return e;\n\n  throw new Error(\"Invalid Element\");\n}\n\nfunction a(e) {\n  return e && !1 === e.newWindow ? \"_self\" : \"_blank\";\n}\n\nfunction d(e, n) {\n  n && (n.hasOwnProperty(\"height\") && (e.height = \"\" + n.height), n.hasOwnProperty(\"width\") && (e.width = \"\" + n.width)), e.height || (e.height = t), e.width || e.setAttribute(\"style\", \"width:100%;\");\n}\n\nvar c = function (e) {\n  var t = this;\n  this.pending = {}, this.port = e, this.port.onmessage = function (e) {\n    if (e.data.payload.__reqid) {\n      var n = e.data.payload.__reqid,\n          i = e.data.payload.__success;\n\n      if (t.pending[n]) {\n        if (delete e.data.payload.__reqid, delete e.data.payload.__success, i) {\n          var o = 0 === Object.keys(e.data.payload).length && e.data.payload.constructor === Object ? null : e.data.payload;\n          t.pending[n].resolve(o);\n        } else {\n          var r = e.data.payload.error ? e.data.type + \": \" + e.data.payload.error : e.data.type;\n          t.pending[n].reject(r);\n        }\n\n        delete t.pending[n];\n      }\n    }\n  };\n};\n\nc.prototype.request = function (e) {\n  var t = this,\n      i = n();\n  return new Promise(function (n, o) {\n    t.pending[i] = {\n      resolve: n,\n      reject: o\n    }, e.payload.__reqid = i, t.port.postMessage(e);\n  });\n};\n\nvar l = function (e, t) {\n  var n = this;\n  this.rdc = new c(e), this.preview = {}, Object.defineProperty(this.preview, \"origin\", {\n    value: t.previewOrigin,\n    writable: !1\n  }), this.editor = {\n    openFile: function (e) {\n      return n.rdc.request({\n        type: \"SDK_OPEN_FILE\",\n        payload: {\n          path: e\n        }\n      });\n    }\n  };\n};\n\nl.prototype.applyFsDiff = function (e) {\n  return this.rdc.request({\n    type: \"SDK_APPLY_FS_DIFF\",\n    payload: e\n  });\n}, l.prototype.getFsSnapshot = function () {\n  return this.rdc.request({\n    type: \"SDK_GET_FS_SNAPSHOT\",\n    payload: {}\n  });\n}, l.prototype.getDependencies = function () {\n  return this.rdc.request({\n    type: \"SDK_GET_DEPS_SNAPSHOT\",\n    payload: {}\n  });\n};\n\nvar p = [],\n    s = function (e) {\n  var t = this;\n  this.id = n(), this.element = e, this.pending = new Promise(function (e, n) {\n    var i = function (n) {\n      n.data.action && \"SDK_INIT_SUCCESS\" === n.data.action && n.data.id === t.id && (t.vm = new l(n.ports[0], n.data.payload), e(t.vm), r());\n    },\n        o = function () {\n      t.element.contentWindow && t.element.contentWindow.postMessage({\n        action: \"SDK_INIT\",\n        id: t.id\n      }, \"*\");\n    };\n\n    function r() {\n      window.clearInterval(d), window.removeEventListener(\"message\", i);\n    }\n\n    window.addEventListener(\"message\", i), o();\n    var a = 0,\n        d = window.setInterval(function () {\n      if (t.vm) r();else {\n        if (a >= 20) return r(), n(\"Timeout: Unable to establish a connection with the StackBlitz VM\"), void p.forEach(function (e, n) {\n          e.id === t.id && p.splice(n, 1);\n        });\n        a++, o();\n      }\n    }, 500);\n  }), p.push(this);\n},\n    u = function (e) {\n  var t = e instanceof Element ? \"element\" : \"id\",\n      n = p.find(function (n) {\n    return n[t] === e;\n  });\n  return n || null;\n},\n    h = [\"typescript\", \"create-react-app\", \"angular-cli\", \"javascript\", \"polymer\", \"vue\"];\n\nfunction f(e, t) {\n  var n = document.createElement(\"input\");\n  return n.type = \"hidden\", n.name = e, n.value = t, n;\n}\n\nfunction m(e) {\n  -1 === h.indexOf(e.template) && console.warn(\"Unsupported project template, must be one of: \" + h.join(\", \"));\n  var t = document.createElement(\"form\");\n  return t.method = \"POST\", t.setAttribute(\"style\", \"display:none;\"), t.appendChild(f(\"project[title]\", e.title)), t.appendChild(f(\"project[description]\", e.description)), t.appendChild(f(\"project[template]\", e.template)), e.tags && e.tags.forEach(function (e) {\n    t.appendChild(f(\"project[tags][]\", e));\n  }), e.dependencies && t.appendChild(f(\"project[dependencies]\", JSON.stringify(e.dependencies))), e.settings && t.appendChild(f(\"project[settings]\", JSON.stringify(e.settings))), Object.keys(e.files).forEach(function (n) {\n    t.appendChild(f(\"project[files][\" + n + \"]\", e.files[n]));\n  }), t;\n}\n\nfunction v(t, n) {\n  var o = m(t);\n  return o.action = e(n) + \"/run\" + i(n), o.id = \"sb\", \"<html><head><title></title></head><body>\" + o.outerHTML + \"<script>document.getElementById('sb').submit();<\\/script></body></html>\";\n}\n\nfunction g(t, n) {\n  var o = m(t);\n  o.action = e(n) + \"/run\" + i(n), o.target = a(n), document.body.appendChild(o), o.submit(), document.body.removeChild(o);\n}\n\nvar y = {\n  connect: function (e) {\n    if (!e || !e.contentWindow) return Promise.reject(\"Provided element is not an iframe.\");\n    var t = u(e);\n    return t ? t.pending : new s(e).pending;\n  },\n  openGithubProject: function (t, n) {\n    window.open(e(n) + \"/github/\" + t + i(n), a(n));\n  },\n  openProject: function (e, t) {\n    g(e, t);\n  },\n  openProjectId: function (t, n) {\n    window.open(e(n) + \"/edit/\" + t + i(n), a(n));\n  },\n  embedGithubProject: function (t, n, a) {\n    var d = r(t),\n        c = document.createElement(\"iframe\");\n    return c.src = e(a) + \"/github/\" + n + i(a), o(d, c, a), y.connect(c);\n  },\n  embedProject: function (e, t, n) {\n    var i = r(e),\n        a = v(t, n),\n        d = document.createElement(\"iframe\");\n    return o(i, d, n), d.contentDocument && d.contentDocument.write(a), y.connect(d);\n  },\n  embedProjectId: function (t, n, a) {\n    var d = r(t),\n        c = document.createElement(\"iframe\");\n    return c.src = e(a) + \"/edit/\" + n + i(a), o(d, c, a), y.connect(c);\n  }\n};\nexport default y; //# sourceMappingURL=sdk.m.js.map","map":null,"metadata":{},"sourceType":"module"}